# HSLL::SpinReadWriteLock - 高性能读写自旋锁

## 场景  
在并发编程中，`mutex` 等锁机制常用于保护共享数据。当读写操作频率相近时，优化空间通常有限。针对**读操作远多于写操作**的场景，**读写锁**可实现多个读者并行访问，从而提升性能。本自旋锁专为**极端多读少写**场景设计（写操作频率极低但同步机制不可或缺），基于原子变量实现高效同步。

## 优点与缺陷  
**优点**：  
- **极低的读延迟**：获取读锁和释放读锁只需一次原子操作，它在多读者频繁读取场景下，性能显著优于 `std::shared_mutex`  

**缺陷**：  
- 较高内存占用：128个槽位配合64字节对齐导致单锁占用8KB内存。（可通过调整槽位数优化内存占用，但可能会导致性能下降） 
- 较高写延迟：获取锁需锁定所有槽位并等待所有读者退出，解锁需要移除所有槽位的写标记，这导致了无论是获取写锁还是释放写锁都有较高延迟。

---

## 性能测试  
测试配置：8个读线程（每线程执行1,250,000次获取/释放读锁操作），10次测试平均吞吐量  
（注：测试场景不包含写操作，符合锁设计目标）  

| 锁类型               | 吞吐量 (百万操作/秒) | 相对性能 (基准: std::shared_mutex) |  
|----------------------|---------------------|----------------------------------------|  
| std::shared_mutex  | 16.6646            | 1.00x (基准)                          |  
| **SpinReadWriteLock** | **405.958**       | **24.36x**                            |  

---

## 测试环境  
| 组件         | 规格说明                         |  
|--------------|----------------------------------|  
| 编译器       | MSVC v143 x64                    |  
| 优化选项     | /O2 (最大速度优化)             |  
| CPU          | Intel i7-11800H (8核/16线程)     |  
| 基础频率     | 2.3 GHz                          |  
| 操作系统     | Windows 10/11 x64 (Build 19045.5737) |  






